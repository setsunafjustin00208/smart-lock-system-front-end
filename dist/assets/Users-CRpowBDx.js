import{A as r,B as j,L as z,E as O,c as i,v as n,f as s,g as u,M as p,N as k,F as _,j as b,t as d,n as f,e as I,U as J}from"./vendor-CclFC5bR.js";import{u as P,f as Q}from"./utils-CZa_Aho3.js";import{_ as q,b as C}from"./index-CxrOhPqN.js";const G={class:"users-view"},H={class:"container is-fluid"},K={class:"columns is-vcentered mb-5"},W={class:"column is-narrow"},X={class:"card glass-effect"},Y={class:"card-content"},Z={key:0,class:"has-text-centered"},ss={key:1},es={class:"columns mb-4"},ts={class:"column is-3-desktop is-12-mobile"},as={class:"control has-icons-left search-control"},ls={class:"user-cards is-hidden-tablet"},os={class:"card-content"},is={class:"media"},ns={class:"media-left"},ds={class:"image is-64x64"},rs={class:"avatar-circle has-background-primary has-text-white is-flex is-align-items-center is-justify-content-center",style:{width:"64px",height:"64px","border-radius":"50%","font-weight":"bold","font-size":"1.5rem"}},cs={class:"media-content"},us={class:"title is-5 has-text-white"},ms={class:"subtitle is-6 has-text-white-ter",style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},vs={class:"mb-3"},fs={class:"is-size-6 has-text-white-ter"},hs={class:"buttons is-right mt-4"},ps=["onClick"],_s=["onClick","disabled"],bs={class:"table-container is-hidden-mobile"},ws={class:"table is-fullwidth is-hoverable"},gs={class:"has-text-white"},ys={class:"has-text-white-ter"},ks={class:"has-text-white-ter"},Cs={class:"buttons are-small"},xs=["onClick"],Us=["onClick","disabled"],Ds={class:"modal-card"},Es={class:"modal-card-head"},Ms={class:"modal-card-title"},Ls={class:"modal-card-body"},Vs={class:"field"},Ns={class:"control"},$s=["disabled"],Fs={class:"field"},Ts={class:"control"},As={key:0,class:"field"},Bs={class:"control"},Rs={class:"field"},Ss={class:"control"},js=["value"],zs={class:"modal-card-foot"},Os={class:"modal-card"},Is={class:"modal-card-body"},Js={class:"modal-card-foot"},Ps=["disabled"],Qs=["disabled"],qs={__name:"Users",setup(Gs){const m=P(),V=r([]),x=r(!1),U=r(!1),D=r(!1),E=r(!1),c=r(null),h=r(""),B=["admin","manager","user","guest"],N=j(()=>V.value.filter(a=>a.username.toLowerCase().includes(h.value.toLowerCase())||a.email.toLowerCase().includes(h.value.toLowerCase())||a.roles.some(e=>e.toLowerCase().includes(h.value.toLowerCase())))),l=z({username:"",email:"",password:"",roles:[]}),M=async()=>{x.value=!0;try{const a=await C.get("/users");V.value=a.data.data.map(e=>({...e,roles:JSON.parse(e.auth_data||"{}").roles||["user"]}))}catch{m.error("Failed to fetch users")}finally{x.value=!1}},R=async()=>{U.value=!0;try{c.value?(await C.put(`/users/${c.value.id}`,{email:l.email,roles:l.roles}),m.success("User updated successfully")):(await C.post("/users",l),m.success("User created successfully")),await M(),y()}catch(a){m.error(a.response?.data?.message||"Failed to save user")}finally{U.value=!1}},$=a=>{c.value=a,l.username=a.username,l.email=a.email,l.password="",l.roles=[...a.roles],E.value=!0},L=r(!1),w=r(null),v=r(!1),F=a=>{w.value=a,L.value=!0},S=async()=>{v.value=!0;try{await C.delete(`/users/${w.value.id}`),m.success("User deleted successfully"),await M(),g()}catch{m.error("Failed to delete user")}finally{v.value=!1}},g=()=>{L.value=!1,w.value=null,v.value=!1},y=()=>{D.value=!1,E.value=!1,c.value=null,Object.assign(l,{username:"",email:"",password:"",roles:[]})},T=a=>{switch(a){case"admin":return"is-danger";case"manager":return"is-warning";case"user":return"is-info";case"guest":return"is-dark";default:return"is-dark"}},A=a=>Q(new Date(a),{addSuffix:!0});return O(()=>{M()}),(a,e)=>(n(),i("div",G,[s("div",H,[s("div",K,[e[7]||(e[7]=s("div",{class:"column"},[s("h1",{class:"title is-2 has-text-white"},[s("i",{class:"fas fa-users mr-3"}),u(" User Management ")])],-1)),s("div",W,[s("button",{class:"button is-primary",onClick:e[0]||(e[0]=t=>D.value=!0)},[...e[6]||(e[6]=[s("i",{class:"fas fa-plus mr-2"},null,-1),u(" Add User ",-1)])])])]),s("div",X,[s("div",Y,[x.value?(n(),i("div",Z,[...e[8]||(e[8]=[s("i",{class:"fas fa-spinner fa-spin fa-2x has-text-white"},null,-1)])])):(n(),i("div",ss,[s("div",es,[e[10]||(e[10]=s("div",{class:"column is-hidden-mobile"},null,-1)),s("div",ts,[s("div",as,[p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>h.value=t),class:"input",type:"text",placeholder:"Search users..."},null,512),[[k,h.value]]),e[9]||(e[9]=s("span",{class:"icon is-left"},[s("i",{class:"fas fa-search"})],-1))])])]),s("div",ls,[(n(!0),i(_,null,b(N.value,t=>(n(),i("div",{key:t.id,class:"card mb-4 glass-effect"},[s("div",os,[s("div",is,[s("div",ns,[s("figure",ds,[s("div",rs,d(t.username.charAt(0).toUpperCase()),1)])]),s("div",cs,[s("p",us,d(t.username),1),s("p",ms,d(t.email),1),s("div",vs,[(n(!0),i(_,null,b(t.roles,o=>(n(),i("span",{key:o,class:f(["tag mr-1",T(o)])},d(o),3))),128))]),s("p",fs,[e[11]||(e[11]=s("i",{class:"fas fa-calendar mr-1"},null,-1)),u(" "+d(A(t.created_at)),1)])])]),s("div",hs,[s("button",{class:"button is-info is-outlined user-action-btn",onClick:o=>$(t)},[...e[12]||(e[12]=[s("i",{class:"fas fa-edit mr-1"},null,-1),u(" Edit ",-1)])],8,ps),s("button",{class:"button is-danger is-outlined user-action-btn",onClick:o=>F(t),disabled:t.username==="admin"},[...e[13]||(e[13]=[s("i",{class:"fas fa-trash mr-1"},null,-1),u(" Delete ",-1)])],8,_s)])])]))),128))]),s("div",bs,[s("table",ws,[e[16]||(e[16]=s("thead",null,[s("tr",null,[s("th",{class:"has-text-white"},"Username"),s("th",{class:"has-text-white"},"Email"),s("th",{class:"has-text-white"},"Roles"),s("th",{class:"has-text-white"},"Created"),s("th",{class:"has-text-white"},"Actions")])],-1)),s("tbody",null,[(n(!0),i(_,null,b(N.value,t=>(n(),i("tr",{key:t.id},[s("td",gs,d(t.username),1),s("td",ys,d(t.email),1),s("td",null,[(n(!0),i(_,null,b(t.roles,o=>(n(),i("span",{key:o,class:f(["tag mr-1",T(o)])},d(o),3))),128))]),s("td",ks,d(A(t.created_at)),1),s("td",null,[s("div",Cs,[s("button",{class:"button is-info is-outlined",onClick:o=>$(t)},[...e[14]||(e[14]=[s("i",{class:"fas fa-edit"},null,-1)])],8,xs),s("button",{class:"button is-danger is-outlined",onClick:o=>F(t),disabled:t.username==="admin"},[...e[15]||(e[15]=[s("i",{class:"fas fa-trash"},null,-1)])],8,Us)])])]))),128))])])])]))])])]),s("div",{class:f(["modal",{"is-active":D.value||E.value}])},[s("div",{class:"modal-background",onClick:y}),s("div",Ds,[s("header",Es,[s("p",Ms,d(c.value?"Edit User":"Create New User"),1),s("button",{class:"delete",onClick:y})]),s("section",Ls,[s("div",Vs,[e[17]||(e[17]=s("label",{class:"label"},"Username",-1)),s("div",Ns,[p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.username=t),class:"input",type:"text",placeholder:"Enter username",disabled:c.value},null,8,$s),[[k,l.username]])])]),s("div",Fs,[e[18]||(e[18]=s("label",{class:"label"},"Email",-1)),s("div",Ts,[p(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.email=t),class:"input",type:"email",placeholder:"Enter email"},null,512),[[k,l.email]])])]),c.value?I("",!0):(n(),i("div",As,[e[19]||(e[19]=s("label",{class:"label"},"Password",-1)),s("div",Bs,[p(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>l.password=t),class:"input",type:"password",placeholder:"Enter password"},null,512),[[k,l.password]])])])),s("div",Rs,[e[20]||(e[20]=s("label",{class:"label"},"Roles",-1)),s("div",Ss,[(n(),i(_,null,b(B,t=>s("label",{class:"checkbox mr-4",key:t},[p(s("input",{type:"checkbox",value:t,"onUpdate:modelValue":e[5]||(e[5]=o=>l.roles=o)},null,8,js),[[J,l.roles]]),u(" "+d(t),1)])),64))])])]),s("footer",zs,[s("button",{class:f(["button is-success",{"is-loading":U.value}]),onClick:R},d(c.value?"Update":"Create"),3),s("button",{class:"button",onClick:y},"Cancel")])])],2),s("div",{class:f(["modal",{"is-active":L.value}])},[s("div",{class:"modal-background",onClick:g}),s("div",Os,[s("header",{class:"modal-card-head"},[e[21]||(e[21]=s("p",{class:"modal-card-title"},"Confirm Deletion",-1)),s("button",{class:"delete",onClick:g})]),s("section",Is,[s("p",null,[e[22]||(e[22]=u("Are you sure you want to delete user ",-1)),s("strong",null,'"'+d(w.value?.username)+'"',1),e[23]||(e[23]=u("?",-1))]),e[24]||(e[24]=s("p",{class:"has-text-danger mt-3"},"This action cannot be undone.",-1))]),s("footer",Js,[s("button",{class:f(["button is-danger",{"is-loading":v.value}]),onClick:S,disabled:v.value}," Delete User ",10,Ps),s("button",{class:"button",onClick:g,disabled:v.value},"Cancel",8,Qs)])])],2)]))}},Xs=q(qs,[["__scopeId","data-v-a488a265"]]);export{Xs as default};
