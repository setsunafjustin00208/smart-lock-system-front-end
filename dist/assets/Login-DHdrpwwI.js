import{I as b,A as r,B as c,L as x,c as u,v as m,f as s,y as k,i as L,M as v,N as f,n as d,g as p,w as T,e as C,t as A,O as E}from"./vendor-DfHZLmVz.js";import{_ as N,u as S,a as V}from"./index-BOl8aQ0f.js";import{u as I}from"./utils-BVVFTmOF.js";const M={class:"login-container"},B={class:"container"},D={class:"login-wrapper"},U={class:"login-form-container"},K={class:"card glass-effect"},O={class:"card-content"},P={class:"field"},q={class:"control has-icons-left"},Y={class:"field"},z={class:"control has-icons-left"},R={class:"field"},j={class:"control"},F=["disabled"],G={__name:"Login",setup(H){const g=b(),_=S();I();const l=r(!1),t=r(""),a=r("");c(()=>"LocKEY");const o=x({username:"",password:""}),h=c(()=>({"is-danger":a.value==="invalid-credentials"||a.value==="system-error","is-warning":a.value==="account-locked"})),w=c(()=>{switch(a.value){case"account-locked":return"fas fa-lock";case"invalid-credentials":return"fas fa-exclamation-triangle";default:return"fas fa-exclamation-circle"}}),y=async i=>{i.preventDefault(),i.stopPropagation(),l.value=!0,t.value="",a.value="";try{const e=await _.login(o);e.success?g.push("/"):(e.status===423||e.error_code==="ACCOUNT_LOCKED"?(t.value=e.message||"Account is locked due to too many failed login attempts. Please try again in 30 minutes.",a.value="account-locked"):(t.value=e.message||"Invalid username or password",a.value="invalid-credentials"),setTimeout(()=>{t.value="",a.value=""},5e3))}catch{t.value="An error occurred during login",a.value="system-error",setTimeout(()=>{t.value="",a.value=""},3e3)}finally{l.value=!1}return!1};return(i,e)=>(m(),u("div",M,[s("div",B,[s("div",D,[s("div",U,[s("div",K,[s("div",O,[e[7]||(e[7]=s("div",{class:"has-text-centered mb-5"},[s("img",{src:V,class:"login-logo",alt:"LocKEY Logo"}),s("p",{class:"subtitle is-6 has-text-white-ter"},"Secure Access Management")],-1)),s("form",{onSubmit:L(y,["prevent"])},[s("div",P,[e[3]||(e[3]=s("label",{class:"label has-text-white"},"Username",-1)),s("div",q,[v(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.username=n),class:"input is-rounded",type:"text",placeholder:"Enter username",required:""},null,512),[[f,o.username]]),e[2]||(e[2]=s("span",{class:"icon is-small is-left"},[s("i",{class:"fas fa-user black-login-icon"})],-1))])]),s("div",Y,[e[5]||(e[5]=s("label",{class:"label has-text-white"},"Password",-1)),s("div",z,[v(s("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>o.password=n),class:"input is-rounded",type:"password",placeholder:"Enter password",required:""},null,512),[[f,o.password]]),e[4]||(e[4]=s("span",{class:"icon is-small is-left"},[s("i",{class:"fas fa-lock black-login-icon"})],-1))])]),s("div",R,[s("div",j,[s("button",{class:d(["button is-primary is-fullwidth is-rounded",{"is-loading":l.value}]),type:"submit",disabled:l.value},[...e[6]||(e[6]=[s("i",{class:"fas fa-sign-in-alt mr-2"},null,-1),p(" Sign In ",-1)])],10,F)])])],32),k(E,{name:"fade"},{default:T(()=>[t.value?(m(),u("div",{key:0,class:d(["notification mt-4 error-message",h.value])},[s("i",{class:d([w.value,"mr-2"])},null,2),p(" "+A(t.value),1)],2)):C("",!0)]),_:1})])])])])])]))}},X=N(G,[["__scopeId","data-v-8348fca6"]]);export{X as default};
