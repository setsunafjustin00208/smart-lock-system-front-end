import{A as m,L as P,B as I,E as j,c as f,v as h,f as s,g as l,M as r,N as V,F as R,j as z,n as g,t as A,u as J,e as q,U as x,O as k,V as G}from"./vendor-CclFC5bR.js";import{_ as K,u as Q,b as w}from"./index-CxrOhPqN.js";import{u as W}from"./utils-CZa_Aho3.js";const X={class:"settings-view"},Y={class:"container is-fluid"},Z={class:"columns"},ss={class:"column is-8"},ts={class:"card glass-effect mb-5"},es={class:"card-content"},as={class:"field"},os={class:"control"},ls=["disabled"],is={class:"field"},ns={class:"control"},rs=["disabled"],ds={class:"field"},cs={class:"control"},us={class:"field is-grouped"},ms={class:"control"},fs={key:0,class:"control"},hs={class:"card glass-effect mb-5"},ps={class:"card-content"},vs={class:"field"},ws={class:"checkbox has-text-white"},gs={class:"field"},bs={class:"control"},ys=["type"],_s={class:"field"},Ps={class:"control"},xs=["type"],ks={class:"field"},Cs={class:"control"},Ss=["type"],Vs={class:"field"},As={class:"control"},Es=["disabled"],Ns={class:"card glass-effect"},Us={class:"card-content"},Fs={class:"field"},Ls={class:"checkbox has-text-white"},Ds={class:"field"},Ms={class:"checkbox has-text-white"},Bs={class:"column is-4"},Hs={class:"card glass-effect mb-5"},Ts={class:"card-content"},$s={class:"content has-text-white-ter"},Os={class:"card glass-effect"},Is={class:"card-content"},js={class:"field"},Rs={__name:"Settings",setup(zs){const d=Q(),n=W(),c=m(!1),b=m(!1),y=m(!1),_=m(!1),C=m("2 days 14 hours"),p=m(!1),i=P({username:"",email:""}),o=P({currentPassword:"",newPassword:"",confirmPassword:""}),u=P({push:!0,lockAlerts:!0}),E=()=>{},N=I(()=>o.currentPassword&&o.newPassword&&o.confirmPassword&&o.newPassword===o.confirmPassword&&o.newPassword.length>=6),U=()=>{i.username=d.user?.username||"",i.email=d.user?.email||"",c.value=!0},F=()=>{c.value=!1,i.username="",i.email=""},L=async()=>{b.value=!0;try{await w.put("/auth/profile",{username:i.username,email:i.email}),d.user.username=i.username,d.user.email=i.email,localStorage.setItem("user",JSON.stringify(d.user)),n.success("Profile updated successfully"),c.value=!1}catch(a){n.error(a.response?.data?.message||"Failed to update profile")}finally{b.value=!1}},D=async()=>{y.value=!0;try{await w.put("/auth/password",{current_password:o.currentPassword,new_password:o.newPassword}),n.success("Password changed successfully"),Object.assign(o,{currentPassword:"",newPassword:"",confirmPassword:""})}catch(a){console.log("Password change error:",a),console.log("Error response:",a.response?.data),n.error(a.response?.data?.message||"Failed to change password")}finally{y.value=!1}},S=async()=>{try{await w.put("/auth/notifications",u),n.success("Notification settings updated")}catch{n.error("Failed to update notification settings")}},M=async()=>{_.value=!0;try{const a=[{timestamp:"2024-11-17 18:00:00",ip_address:"192.168.1.100",user_agent:"Chrome/119.0"},{timestamp:"2024-11-17 09:30:00",ip_address:"192.168.1.100",user_agent:"Chrome/119.0"},{timestamp:"2024-11-16 17:45:00",ip_address:"10.0.0.50",user_agent:"Firefox/118.0"}];let t='<div class="content"><h4>Login History</h4><ul>';a.forEach(v=>{t+=`<li><strong>${v.timestamp}</strong> - ${v.ip_address} (${v.user_agent})</li>`}),t+="</ul></div>";const e=document.createElement("div");e.innerHTML=`
      <div class="modal is-active">
        <div class="modal-background" onclick="this.parentElement.remove()"></div>
        <div class="modal-card">
          <header class="modal-card-head">
            <p class="modal-card-title">Login History</p>
            <button class="delete" onclick="this.closest('.modal').remove()"></button>
          </header>
          <section class="modal-card-body">${t}</section>
          <footer class="modal-card-foot">
            <button class="button" onclick="this.closest('.modal').remove()">Close</button>
          </footer>
        </div>
      </div>
    `,document.body.appendChild(e),n.success("Login history loaded")}catch{n.error("Failed to load login history")}finally{_.value=!1}},B=()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&H()},H=async()=>{try{await w.delete("/auth/account"),n.success("Account deleted successfully"),d.logout()}catch{n.error("Failed to delete account")}},T=a=>{switch(a){case"admin":return"is-danger";case"manager":return"is-warning";case"user":return"is-info";case"guest":return"is-light";default:return"is-light"}},$=async()=>{try{const a=await w.get("/auth/notifications");Object.assign(u,a.data.data)}catch{}};return j(()=>{$(),setInterval(()=>{const a=new Date,t=new Date(a.getTime()-2880*60*1e3-840*60*1e3),e=a-t,v=Math.floor(e/(1440*60*1e3)),O=Math.floor(e%(1440*60*1e3)/(3600*1e3));C.value=`${v} days ${O} hours`},6e4)}),(a,t)=>(h(),f("div",X,[s("div",Y,[t[29]||(t[29]=s("div",{class:"columns"},[s("div",{class:"column"},[s("h1",{class:"title is-2 has-text-white mb-5"},[s("i",{class:"fas fa-cog mr-3"}),l(" Settings ")])])],-1)),s("div",Z,[s("div",ss,[s("div",ts,[t[13]||(t[13]=s("div",{class:"card-header"},[s("p",{class:"card-header-title has-text-white"},[s("i",{class:"fas fa-user mr-2"}),l(" Profile Settings ")])],-1)),s("div",es,[s("div",as,[t[8]||(t[8]=s("label",{class:"label has-text-white"},"Username",-1)),s("div",os,[r(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.username=e),class:"input",type:"text",disabled:!c.value},null,8,ls),[[V,i.username]])])]),s("div",is,[t[9]||(t[9]=s("label",{class:"label has-text-white"},"Email",-1)),s("div",ns,[r(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.email=e),class:"input",type:"email",disabled:!c.value},null,8,rs),[[V,i.email]])])]),s("div",ds,[t[10]||(t[10]=s("label",{class:"label has-text-white"},"Roles",-1)),s("div",cs,[(h(!0),f(R,null,z(J(d).user?.roles,e=>(h(),f("span",{key:e,class:g(["tag mr-1",T(e)])},A(e),3))),128))])]),s("div",us,[s("div",ms,[c.value?(h(),f("button",{key:1,class:g(["button is-success",{"is-loading":b.value}]),onClick:L},[...t[12]||(t[12]=[s("i",{class:"fas fa-save mr-2"},null,-1),l(" Save Changes ",-1)])],2)):(h(),f("button",{key:0,class:"button is-primary",onClick:U},[...t[11]||(t[11]=[s("i",{class:"fas fa-edit mr-2"},null,-1),l(" Edit Profile ",-1)])]))]),c.value?(h(),f("div",fs,[s("button",{class:"button",onClick:F}," Cancel ")])):q("",!0)])])]),s("div",hs,[t[19]||(t[19]=s("div",{class:"card-header"},[s("p",{class:"card-header-title has-text-white"},[s("i",{class:"fas fa-key mr-2"}),l(" Change Password ")])],-1)),s("div",ps,[s("div",vs,[s("label",ws,[r(s("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),onChange:E},null,544),[[x,p.value]]),t[14]||(t[14]=l(" Show passwords ",-1))])]),s("div",gs,[t[15]||(t[15]=s("label",{class:"label has-text-white"},"Current Password",-1)),s("div",bs,[r(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.currentPassword=e),class:"input",type:p.value?"text":"password",placeholder:"Enter current password"},null,8,ys),[[k,o.currentPassword]])])]),s("div",_s,[t[16]||(t[16]=s("label",{class:"label has-text-white"},"New Password",-1)),s("div",Ps,[r(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.newPassword=e),class:"input",type:p.value?"text":"password",placeholder:"Enter new password"},null,8,xs),[[k,o.newPassword]])])]),s("div",ks,[t[17]||(t[17]=s("label",{class:"label has-text-white"},"Confirm New Password",-1)),s("div",Cs,[r(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>o.confirmPassword=e),class:"input",type:p.value?"text":"password",placeholder:"Confirm new password"},null,8,Ss),[[k,o.confirmPassword]])])]),s("div",Vs,[s("div",As,[s("button",{class:g(["button is-warning",{"is-loading":y.value}]),onClick:D,disabled:!N.value},[...t[18]||(t[18]=[s("i",{class:"fas fa-key mr-2"},null,-1),l(" Change Password ",-1)])],10,Es)])])])]),s("div",Ns,[t[22]||(t[22]=s("div",{class:"card-header"},[s("p",{class:"card-header-title has-text-white"},[s("i",{class:"fas fa-bell mr-2"}),l(" Notification Settings ")])],-1)),s("div",Us,[s("div",Fs,[s("label",Ls,[r(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>u.push=e),type:"checkbox",onChange:S},null,544),[[x,u.push]]),t[20]||(t[20]=l(" Push Notifications ",-1))])]),s("div",Ds,[s("label",Ms,[r(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>u.lockAlerts=e),type:"checkbox",onChange:S},null,544),[[x,u.lockAlerts]]),t[21]||(t[21]=l(" Lock Status Alerts ",-1))])])])])]),s("div",Bs,[s("div",Hs,[t[25]||(t[25]=s("div",{class:"card-header"},[s("p",{class:"card-header-title has-text-white"},[s("i",{class:"fas fa-info-circle mr-2"}),l(" System Information ")])],-1)),s("div",Ts,[s("div",$s,[t[24]||(t[24]=G('<p data-v-b35c4659><strong class="has-text-white" data-v-b35c4659>Version:</strong> 3.0.0</p><p data-v-b35c4659><strong class="has-text-white" data-v-b35c4659>Build:</strong> 2025.11.02</p><p data-v-b35c4659><strong class="has-text-white" data-v-b35c4659>Environment:</strong> Production</p><p data-v-b35c4659><strong class="has-text-white" data-v-b35c4659>Backend:</strong> Connected</p><p data-v-b35c4659><strong class="has-text-white" data-v-b35c4659>Database:</strong> Online</p>',5)),s("p",null,[t[23]||(t[23]=s("strong",{class:"has-text-white"},"Uptime:",-1)),l(" "+A(C.value),1)])])])]),s("div",Os,[t[28]||(t[28]=s("div",{class:"card-header"},[s("p",{class:"card-header-title has-text-white"},[s("i",{class:"fas fa-shield-alt mr-2"}),l(" Account Security ")])],-1)),s("div",Is,[s("div",js,[s("button",{class:g(["button is-warning is-fullwidth mb-3",{"is-loading":_.value}]),onClick:M},[...t[26]||(t[26]=[s("i",{class:"fas fa-history mr-2"},null,-1),l(" View Login History ",-1)])],2)]),s("div",{class:"field"},[s("button",{class:"button is-danger is-fullwidth",onClick:B},[...t[27]||(t[27]=[s("i",{class:"fas fa-trash mr-2"},null,-1),l(" Delete Account ",-1)])])])])])])])])]))}},Ks=K(Rs,[["__scopeId","data-v-b35c4659"]]);export{Ks as default};
