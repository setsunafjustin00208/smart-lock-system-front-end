import{A as r,L as z,E as B,c as i,v as n,f as s,g as u,F as h,j as _,t as d,n as f,e as S,M as g,N,P as L}from"./vendor-vMbJagej.js";import{u as O,f as P}from"./utils-BKUfGzfw.js";import{_ as I,b as k}from"./index-BoJB1KP9.js";const J={class:"users-view"},q={class:"container is-fluid"},G={class:"columns is-vcentered mb-5"},H={class:"column is-narrow"},K={class:"card glass-effect"},Q={class:"card-content"},W={key:0,class:"has-text-centered"},X={key:1},Y={class:"user-cards is-hidden-tablet"},Z={class:"card-content"},ss={class:"media"},es={class:"media-left"},ts={class:"image is-64x64"},as={class:"avatar-circle has-background-primary has-text-white is-flex is-align-items-center is-justify-content-center",style:{width:"64px",height:"64px","border-radius":"50%","font-weight":"bold","font-size":"1.5rem"}},ls={class:"media-content"},os={class:"title is-5 has-text-white"},is={class:"subtitle is-6 has-text-white-ter",style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},ns={class:"mb-3"},ds={class:"is-size-6 has-text-white-ter"},rs={class:"buttons is-right mt-4"},cs=["onClick"],us=["onClick","disabled"],ms={class:"table-container is-hidden-mobile"},vs={class:"table is-fullwidth is-hoverable"},fs={class:"has-text-white"},hs={class:"has-text-white-ter"},_s={class:"has-text-white-ter"},bs={class:"buttons are-small"},ps=["onClick"],ws=["onClick","disabled"],gs={class:"modal-card"},ks={class:"modal-card-head"},ys={class:"modal-card-title"},xs={class:"modal-card-body"},Cs={class:"field"},Us={class:"control"},Ds=["disabled"],Es={class:"field"},Ms={class:"control"},Ns={key:0,class:"field"},Vs={class:"control"},$s={class:"field"},Fs={class:"control"},Ts=["value"],As={class:"modal-card-foot"},Rs={class:"modal-card"},js={class:"modal-card-body"},zs={class:"modal-card-foot"},Bs=["disabled"],Ss=["disabled"],Ls={__name:"Users",setup(Os){const m=O(),y=r([]),x=r(!1),C=r(!1),U=r(!1),D=r(!1),c=r(null),A=["admin","manager","user","guest"],l=z({username:"",email:"",password:"",roles:[]}),E=async()=>{x.value=!0;try{const a=await k.get("/users");y.value=a.data.data.map(e=>({...e,roles:JSON.parse(e.auth_data||"{}").roles||["user"]}))}catch{m.error("Failed to fetch users")}finally{x.value=!1}},R=async()=>{C.value=!0;try{c.value?(await k.put(`/users/${c.value.id}`,{email:l.email,roles:l.roles}),m.success("User updated successfully")):(await k.post("/users",l),m.success("User created successfully")),await E(),w()}catch(a){m.error(a.response?.data?.message||"Failed to save user")}finally{C.value=!1}},V=a=>{c.value=a,l.username=a.username,l.email=a.email,l.password="",l.roles=[...a.roles],D.value=!0},M=r(!1),b=r(null),v=r(!1),$=a=>{b.value=a,M.value=!0},j=async()=>{v.value=!0;try{await k.delete(`/users/${b.value.id}`),m.success("User deleted successfully"),await E(),p()}catch{m.error("Failed to delete user")}finally{v.value=!1}},p=()=>{M.value=!1,b.value=null,v.value=!1},w=()=>{U.value=!1,D.value=!1,c.value=null,Object.assign(l,{username:"",email:"",password:"",roles:[]})},F=a=>{switch(a){case"admin":return"is-danger";case"manager":return"is-warning";case"user":return"is-info";case"guest":return"is-dark";default:return"is-dark"}},T=a=>P(new Date(a),{addSuffix:!0});return B(()=>{E()}),(a,e)=>(n(),i("div",J,[s("div",q,[s("div",G,[e[6]||(e[6]=s("div",{class:"column"},[s("h1",{class:"title is-2 has-text-white"},[s("i",{class:"fas fa-users mr-3"}),u(" User Management ")])],-1)),s("div",H,[s("button",{class:"button is-primary",onClick:e[0]||(e[0]=t=>U.value=!0)},[...e[5]||(e[5]=[s("i",{class:"fas fa-plus mr-2"},null,-1),u(" Add User ",-1)])])])]),s("div",K,[s("div",Q,[x.value?(n(),i("div",W,[...e[7]||(e[7]=[s("i",{class:"fas fa-spinner fa-spin fa-2x has-text-white"},null,-1)])])):(n(),i("div",X,[s("div",Y,[(n(!0),i(h,null,_(y.value,t=>(n(),i("div",{key:t.id,class:"card mb-4 glass-effect"},[s("div",Z,[s("div",ss,[s("div",es,[s("figure",ts,[s("div",as,d(t.username.charAt(0).toUpperCase()),1)])]),s("div",ls,[s("p",os,d(t.username),1),s("p",is,d(t.email),1),s("div",ns,[(n(!0),i(h,null,_(t.roles,o=>(n(),i("span",{key:o,class:f(["tag mr-1",F(o)])},d(o),3))),128))]),s("p",ds,[e[8]||(e[8]=s("i",{class:"fas fa-calendar mr-1"},null,-1)),u(" "+d(T(t.created_at)),1)])])]),s("div",rs,[s("button",{class:"button is-info is-outlined user-action-btn",onClick:o=>V(t)},[...e[9]||(e[9]=[s("i",{class:"fas fa-edit mr-1"},null,-1),u(" Edit ",-1)])],8,cs),s("button",{class:"button is-danger is-outlined user-action-btn",onClick:o=>$(t),disabled:t.username==="admin"},[...e[10]||(e[10]=[s("i",{class:"fas fa-trash mr-1"},null,-1),u(" Delete ",-1)])],8,us)])])]))),128))]),s("div",ms,[s("table",vs,[e[13]||(e[13]=s("thead",null,[s("tr",null,[s("th",{class:"has-text-white"},"Username"),s("th",{class:"has-text-white"},"Email"),s("th",{class:"has-text-white"},"Roles"),s("th",{class:"has-text-white"},"Created"),s("th",{class:"has-text-white"},"Actions")])],-1)),s("tbody",null,[(n(!0),i(h,null,_(y.value,t=>(n(),i("tr",{key:t.id},[s("td",fs,d(t.username),1),s("td",hs,d(t.email),1),s("td",null,[(n(!0),i(h,null,_(t.roles,o=>(n(),i("span",{key:o,class:f(["tag mr-1",F(o)])},d(o),3))),128))]),s("td",_s,d(T(t.created_at)),1),s("td",null,[s("div",bs,[s("button",{class:"button is-info is-outlined",onClick:o=>V(t)},[...e[11]||(e[11]=[s("i",{class:"fas fa-edit"},null,-1)])],8,ps),s("button",{class:"button is-danger is-outlined",onClick:o=>$(t),disabled:t.username==="admin"},[...e[12]||(e[12]=[s("i",{class:"fas fa-trash"},null,-1)])],8,ws)])])]))),128))])])])]))])])]),s("div",{class:f(["modal",{"is-active":U.value||D.value}])},[s("div",{class:"modal-background",onClick:w}),s("div",gs,[s("header",ks,[s("p",ys,d(c.value?"Edit User":"Create New User"),1),s("button",{class:"delete",onClick:w})]),s("section",xs,[s("div",Cs,[e[14]||(e[14]=s("label",{class:"label"},"Username",-1)),s("div",Us,[g(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.username=t),class:"input",type:"text",placeholder:"Enter username",disabled:c.value},null,8,Ds),[[N,l.username]])])]),s("div",Es,[e[15]||(e[15]=s("label",{class:"label"},"Email",-1)),s("div",Ms,[g(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.email=t),class:"input",type:"email",placeholder:"Enter email"},null,512),[[N,l.email]])])]),c.value?S("",!0):(n(),i("div",Ns,[e[16]||(e[16]=s("label",{class:"label"},"Password",-1)),s("div",Vs,[g(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.password=t),class:"input",type:"password",placeholder:"Enter password"},null,512),[[N,l.password]])])])),s("div",$s,[e[17]||(e[17]=s("label",{class:"label"},"Roles",-1)),s("div",Fs,[(n(),i(h,null,_(A,t=>s("label",{class:"checkbox mr-4",key:t},[g(s("input",{type:"checkbox",value:t,"onUpdate:modelValue":e[4]||(e[4]=o=>l.roles=o)},null,8,Ts),[[L,l.roles]]),u(" "+d(t),1)])),64))])])]),s("footer",As,[s("button",{class:f(["button is-success",{"is-loading":C.value}]),onClick:R},d(c.value?"Update":"Create"),3),s("button",{class:"button",onClick:w},"Cancel")])])],2),s("div",{class:f(["modal",{"is-active":M.value}])},[s("div",{class:"modal-background",onClick:p}),s("div",Rs,[s("header",{class:"modal-card-head"},[e[18]||(e[18]=s("p",{class:"modal-card-title"},"Confirm Deletion",-1)),s("button",{class:"delete",onClick:p})]),s("section",js,[s("p",null,[e[19]||(e[19]=u("Are you sure you want to delete user ",-1)),s("strong",null,'"'+d(b.value?.username)+'"',1),e[20]||(e[20]=u("?",-1))]),e[21]||(e[21]=s("p",{class:"has-text-danger mt-3"},"This action cannot be undone.",-1))]),s("footer",zs,[s("button",{class:f(["button is-danger",{"is-loading":v.value}]),onClick:j,disabled:v.value}," Delete User ",10,Bs),s("button",{class:"button",onClick:p,disabled:v.value},"Cancel",8,Ss)])])],2)]))}},qs=I(Ls,[["__scopeId","data-v-141c2378"]]);export{qs as default};
