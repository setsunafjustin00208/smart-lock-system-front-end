import{I as b,A as r,B as u,L as k,c as v,v as f,f as s,y as x,i as L,M as m,N as T,O as C,n as c,g as p,w as A,e as E,t as M,P as N}from"./vendor-CclFC5bR.js";import{_ as S,u as V,a as D}from"./index-CxrOhPqN.js";import{u as I}from"./utils-CZa_Aho3.js";const P={class:"login-container"},B={class:"container"},U={class:"login-wrapper"},K={class:"login-form-container"},O={class:"card glass-effect"},q={class:"card-content"},Y={class:"field"},z={class:"control has-icons-left"},R={class:"field"},$={class:"control has-icons-left has-icons-right"},j=["type"],F={class:"field"},G={class:"control"},H=["disabled"],J={__name:"Login",setup(Q){const g=b(),_=V();I();const l=r(!1),t=r(""),a=r(""),i=r(!1);u(()=>"LocKEY");const o=k({username:"",password:""}),h=u(()=>({"is-danger":a.value==="invalid-credentials"||a.value==="system-error","is-warning":a.value==="account-locked"})),w=u(()=>{switch(a.value){case"account-locked":return"fas fa-lock";case"invalid-credentials":return"fas fa-exclamation-triangle";default:return"fas fa-exclamation-circle"}}),y=async d=>{d.preventDefault(),d.stopPropagation(),l.value=!0,t.value="",a.value="";try{const e=await _.login(o);e.success?g.push("/"):(e.status===423||e.error_code==="ACCOUNT_LOCKED"?(t.value=e.message||"Account is locked due to too many failed login attempts. Please try again in 30 minutes.",a.value="account-locked"):(t.value=e.message||"Invalid username or password",a.value="invalid-credentials"),setTimeout(()=>{t.value="",a.value=""},5e3))}catch{t.value="An error occurred during login",a.value="system-error",setTimeout(()=>{t.value="",a.value=""},3e3)}finally{l.value=!1}return!1};return(d,e)=>(f(),v("div",P,[s("div",B,[s("div",U,[s("div",K,[s("div",O,[s("div",q,[e[8]||(e[8]=s("div",{class:"has-text-centered mb-5"},[s("img",{src:D,class:"login-logo",alt:"LocKEY Logo"}),s("p",{class:"subtitle is-6 has-text-white-ter"},"Secure Access Management")],-1)),s("form",{onSubmit:L(y,["prevent"])},[s("div",Y,[e[4]||(e[4]=s("label",{class:"label has-text-white"},"Username",-1)),s("div",z,[m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.username=n),class:"input is-rounded",type:"text",placeholder:"Enter username",required:""},null,512),[[T,o.username]]),e[3]||(e[3]=s("span",{class:"icon is-small is-left"},[s("i",{class:"fas fa-user black-login-icon"})],-1))])]),s("div",R,[e[6]||(e[6]=s("label",{class:"label has-text-white"},"Password",-1)),s("div",$,[m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>o.password=n),class:"input is-rounded",type:i.value?"text":"password",placeholder:"Enter password",required:""},null,8,j),[[C,o.password]]),e[5]||(e[5]=s("span",{class:"icon is-small is-left"},[s("i",{class:"fas fa-lock black-login-icon"})],-1)),s("span",{class:"icon is-small is-right is-clickable",onClick:e[2]||(e[2]=n=>i.value=!i.value)},[s("i",{class:c([i.value?"fas fa-eye-slash":"fas fa-eye","black-login-icon"])},null,2)])])]),s("div",F,[s("div",G,[s("button",{class:c(["button is-primary is-fullwidth is-rounded",{"is-loading":l.value}]),type:"submit",disabled:l.value},[...e[7]||(e[7]=[s("i",{class:"fas fa-sign-in-alt mr-2"},null,-1),p(" Sign In ",-1)])],10,H)])])],32),x(N,{name:"fade"},{default:A(()=>[t.value?(f(),v("div",{key:0,class:c(["notification mt-4 error-message",h.value])},[s("i",{class:c([w.value,"mr-2"])},null,2),p(" "+M(t.value),1)],2)):E("",!0)]),_:1})])])])])])]))}},ss=S(J,[["__scopeId","data-v-9c0b5fe9"]]);export{ss as default};
